function remove_ultimo_campo(a){let[e,o,r]=[a.target.name,a.data.variavel,a.data.nome_botao_adicionar];$(`#${o} > tbody > tr `).filter((a,o)=>{if($(o).find(`[name*="${e}"]`).length>0)return o}).remove(),$(`#${o} > tbody`).children().length==("links"==o?MAX_LINKS-1:"imagens"==o?MAX_IMAGENS-1:MAX_PALAVRAS_CHAVE-1)&&$(`#${r}`).prop("disabled",!1)}function adiciona_bloco(a){let[e,o,r,t]=[a.data.variavel,a.data.nome_botao_remover,a.data.nome_botao_adicionar,a.data.callback];if(0==$(`#${e} > tbody`).children().length){let n;n="links"==e?$($.parseHTML(A)).find(":nth-child(1)"):"imagens"==e?$($.parseHTML(B)).find(":nth-child(1)"):$($.parseHTML(C)).find(":nth-child(1)"),$(n).children("[id *= -erro-]").remove(),n=$(n).find(":nth-child(1)").get(0).outerHTML,$(`#${e} > tbody`).append(n.replaceAll(RegExp(`${e}-[0-9]+`,"g"),e+"-0")),$(`#${e} tbody tr [name*="-${o}"]:last`).on("click",a.data,t);return}let i=String($(`#${e} > tbody > tr:last > td > fieldset`).attr("name")),[c,l]=[i.split("-")[0],Number(i.split("-")[1])+1],m=$(`#${e} > tbody > tr:last`).clone();$(m).find("[id *= -erro-]").remove(),$(m).html($(m).html().replaceAll(RegExp(`${c}-[0-9]+`,"g"),c+"-"+l)),$(`#${e}`).append($(m).prop("outerHTML")),$(`#${e} tbody tr [name*="-${o}"]:last`).on("click",a.data,t),"imagens"==e&&$("#imagens tbody tr input[type='file']:last").prev().css("background-color","").css("color",""),$(`#${e} > tbody`).children().length==("links"==e?MAX_LINKS:"imagens"==e?MAX_IMAGENS:MAX_PALAVRAS_CHAVE)&&$(`#${r}`).prop("disabled",!0)}function obtem_progresso(a){$.ajax({url:`/api/obter_progresso/${a}`,type:"GET",dataType:"text",processData:!1,contentType:!1,success(a){porcentagem=(100*a).toFixed(2),$("#barra-carregamento").css("width",porcentagem+"%"),$("#barra-carregamento").text(Math.round(porcentagem)+"%"),$("#barra-carregamento").attr("aria-valuenow",porcentagem),100==Math.round(porcentagem)&&clearInterval(id_intervalo)}})}MAX_LINKS=8,MAX_IMAGENS=MAX_PALAVRAS_CHAVE=12,id_intervalo=void 0,id_solicitacao=Math.floor(Math.random()*(1e20-1)+1).toString(),$("#adicionar_campo_link").on("click",{variavel:"links",nome_botao_remover:"remover_campo_link",nome_botao_adicionar:"adicionar_campo_link",callback:remove_ultimo_campo},adiciona_bloco),$("#adicionar_campo_imagem").on("click",{variavel:"imagens",nome_botao_remover:"remover_campo_imagem",nome_botao_adicionar:"adicionar_campo_imagem",callback:remove_ultimo_campo},adiciona_bloco),$("#adicionar_campo_palavras_chave").on("click",{variavel:"palavras_chave",nome_botao_remover:"remover_campo_palavras_chave",nome_botao_adicionar:"adicionar_campo_palavras_chave",callback:remove_ultimo_campo},adiciona_bloco),$('#links [name*="-remover_campo_link"]').on("click",{variavel:"links",nome_botao_adicionar:"adicionar_campo_link"},remove_ultimo_campo),$('#imagens [name*="-remover_campo_imagem"]').on("click",{variavel:"imagens",nome_botao_adicionar:"adicionar_campo_imagem"},remove_ultimo_campo),$('#palavras_chave [name*="-remover_campo_palavras_chave"]').on("click",{variavel:"palavras_chave",nome_botao_adicionar:"adicionar_campo_palavras_chave"},remove_ultimo_campo),$(":root").on("change",'input[type="file"]',function(a){let e=a.target.files;for(let o=0;o<e.length;o++)-1==e[o].name.search(/(.png|.jpeg|.jpg|.jfif)$/g)&&$(`input[name="${a.target.name}"]`).val(""),$(`input[name="${a.target.name}"]`).val()?$(`input[name="${a.target.name}"]`).prev().css("background-color","green").css("color","white"):$(`input[name="${a.target.name}"]`).prev().css("background-color","").css("color","")}),["nome","trajetoria","producao","ultima_atualizacao","pesquisante","email_pesquisante","data_nascimento","genero","pagina"].forEach(a=>{$(`#${a}`).on("input",function(e){$("#"+a+"-erro").remove(),$(e.target).off("input")})}),["links","imagens","palavras_chave"].forEach(a=>{$(`#${a} td input`).on("input",function(a){$(a.target).parent($(`#${a.target.id}`)).next("[id *= -erro-]").remove(),$(a.target).off("input")})}),$("form").submit(function(a){a.preventDefault(),$.ajax({type:"POST",contentType:!1,data:new FormData(this),dataType:"html",processData:!1,beforeSend:function(){$("body").prepend($.parseHTML(HTML_BARRA_PROGRESSO)),$("body").css("scrollbar-width","100vh"),id_intervalo=setInterval(obtem_progresso,500,id_solicitacao),this.data.append("id_solicitacao",id_solicitacao)},success(a){clearInterval(id_intervalo),document.open(),document.write(a),document.close()},error(a){clearInterval(id_intervalo),document.write(a.responseText),document.close()}})});